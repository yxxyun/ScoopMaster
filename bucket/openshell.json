{
    "version": "4.4.196",
    "description": "A fork of Classic Shell with additional fixes and more features.",
    "homepage": "https://github.com/Open-Shell/Open-Shell-Menu",
    "license": "MIT",
    "url": "https://github.com/Open-Shell/Open-Shell-Menu/releases/download/v4.4.196/OpenShellSetup_4_4_196.exe#/setup.exe",
    "hash": "5a8c5afac76973dd0c26b423ede8453813a01953c28f46b640549f7f2e9ae443",
    "architecture": {
        "64bit": {
            "pre_install": [
                "Start-Process \"$dir\\setup.exe\" -Wait -ArgumentList 'extract64' -WorkingDirectory \"$dir\"",
                "Remove-Item \"$dir\\setup.exe\"",
                "Get-ChildItem \"$dir\\*.msi\" | Rename-Item -NewName 'setup.msi'"
            ]
        }
    },
    "installer": {
        "script": [
            "if (-not (is_admin)) {",
            "    error \"$app requires admin rights to $cmd\"",
            "    break",
            "}",
            "[void](mkdir -ea 0 \"$env:programfiles\\Open-Shell\\Skins\")",
            "cp -force $bucketsdir\\$bucket\\scripts\\openshell\\ame.skin7 \"$env:programfiles\\Open-Shell\\Skins\"",
            "reg import $bucketsdir\\$bucket\\scripts\\openshell\\openshell.reg",
            "$proc = start-process 'msiexec' -NoNewWindow -passthru -argumentlist \"/i $dir\\setup.msi /qn ADDLOCAL=StartMenu\"",
            "if (-not $proc.waitforexit(10000)) {",
            "   write-host -F red 'failed installing openshell due to timeout (10 seconds)'",
            "   error 'failed installing openshell'",
            "   break",
            "}",
            "if (get-process explorer -ea 0) {",
            "    stop-process -name 'explorer' -force",
            "}"
        ]
    },
    "pre_uninstall": [
        "if (-not (is_admin)) {",
        "    error \"$app requires admin rights to $cmd\"",
        "    break",
        "}",
        "$proc = start-process 'msiexec' -NoNewWindow -passthru -argumentlist \"/x $dir\\setup.msi /qn\"",
        "if (-not $proc.waitforexit(10000)) {",
        "    error 'failed uninstalling openshell due to timeout (10 seconds)'",
        "    break",
        "}",
        "rm -r -force -ea 0 \"HKCU:\\Software\\OpenShell\"",
        "rm -r -force -ea 0 \"$env:programfiles\\Open-Shell\"",
        "rm -r -force -ea 0 \"$env:localappdata\\openshell\"",
        "if (get-process explorer -ea 0) {",
        "    stop-process -name 'explorer' -force",
        "}"
    ],
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/Open-Shell/Open-Shell-Menu/releases/download/v$version/OpenShellSetup_$underscoreVersion.exe#/setup.exe"
    }
}
