{
    "version": "2.6.1",
    "description": "启用并更新wsl",
    "homepage": "https://github.com/microsoft/WSL",
    "license": "Freeware",
    "url": "https://github.com/microsoft/WSL/releases/download/2.6.1/wsl.2.6.1.0.x64.msi#/wsl.msi_",
    "hash": "593cace63530e67bd3a19fde9ac2a272efe3734d03afddacb8394de7055b6235",
    "depends": [
        "ChuckieChen945_Chuckie_s/v2rayn-core-self-contained",
        "main/gsudo"
    ],
    "pre_install": [
        "# Enable WSL 2 and Virtual Machine Platform features",
        "gsudo Enable-WindowsOptionalFeature -FeatureName 'VirtualMachinePlatform' -All -Online -NoRestart -LimitAccess",
        "gsudo Enable-WindowsOptionalFeature -FeatureName 'Microsoft-Windows-Subsystem-Linux' -All -Online -NoRestart -LimitAccess"
    ],
    "installer": {
        "script": [
            "# Wsl",
            "Invoke-ExternalCommand 'msiexec' -ArgumentList @('/i', \"$dir\\wsl.msi_\", '/passive', '/norestart')",
            "# wsb",
            "if($env:USERNAME -ne 'WDAGUtilityAccount') {",
            "    gsudo Enable-WindowsOptionalFeature -FeatureName 'Containers-DisposableClientVM' -All -Online -NoRestart -LimitAccess",
            "}"
        ]
    },
    "post_install": [
        "Remove-Item -Path \"$dir\\wsl.msi_\" -ErrorAction SilentlyContinue -Recurse -Force",
        "# Set network",
        "Set-NetFirewallHyperVVMSetting -Name '{40E0AC32-46A5-438A-A0B2-2B479E8F2E90}' -DefaultInboundAction Allow",
        "Set-NetFirewallHyperVVMSetting -Name '{40E0AC32-46A5-438A-A0B2-2B479E8F2E90}' -Enabled False",
        "# 为 WSL 应用启用“回环网络访问”权限, 适配 tun 模式",
        "EnableLoopback -all"
    ],
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/microsoft/WSL/releases/download/$version/wsl.$version.0.x64.msi#/wsl.msi_"
    }
}
