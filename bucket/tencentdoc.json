{
    "##": "腾讯文档",
    "version": "3.9.7",
    "description": "[腾讯文档] 支持多人在线编辑文档",
    "homepage": "https://docs.qq.com",
    "license": "Freeware",
    "url": "https://desktop.docs.qq.com/Installer/30001/3.9.7/TencentDocs-x86_64.exe#/dl.7z",
    "hash": "c26dcaabb5d32f6d009f5eccfa618963c375c33c0e2b3c5d57f5b79a1c05243e",
    "architecture": {
        "64bit": {
            "pre_install": "Expand-7zipArchive \"$dir\\`$PLUGINSDIR\\app-64.7z\" \"$dir\""
        },
        "32bit": {
            "pre_install": "Expand-7zipArchive \"$dir\\`$PLUGINSDIR\\app-32.7z\" \"$dir\""
        }
    },
    "pre_install": [
        "Rename-Item \"$dir\\`$_*_\" \"$dir\\$version\"",
        "Remove-Item \"$dir\\`$*\", \"$dir\\TencentDocs_new.exe\" -Recurse -Force",
        "startmenu_shortcut -target $(Get-Item \"$dir\\TencentDocs.exe\") -shortcutName \"Tencent Docs\"",
        "startmenu_shortcut -target $(Get-Item \"$dir\\TencentDocs.exe\") -shortcutName \"腾讯文档\""
    ],
    "post_install": "Remove-Item \"$dir\\`$*\" -Force -Recurse",
    "pre_uninstall": [
        "if (Get-Process -Name \"TencentDocs\" -Erroraction SilentlyContinue) {Stop-Process -Name \"TencentDocs\"}",
        "if (Test-Path \"$(shortcut_folder)Tencent Docs.lnk\") {Remove-Item \"$(shortcut_folder)Tencent Docs.lnk\" -Force}",
        "if (Test-Path \"$(shortcut_folder)腾讯文档.lnk\") {Remove-Item \"$(shortcut_folder)腾讯文档.lnk\" -Force}"
    ],
    "shortcuts": [
        [
            "TencentDocs.exe",
            "Tencent Docs"
        ],
        [
            "TencentDocs.exe",
            "腾讯文档"
        ]
    ],
    "checkver": {
        "script": [
            "$url='https://docs.qq.com/api/package/get?channel_id=30001&version_id=latest&package_name=TencentDocs-x86_64.exe'",
            "try {Invoke-WebRequest -Uri $url -MaximumRedirection 0 } catch {$_.Exception.Response.Headers.Location.AbsoluteUri}"
        ],
        "regex": "/(\\d+\\.\\d+\\.\\d+)/"
    },
    "autoupdate": {
        "url": "https://desktop.docs.qq.com/Installer/30001/$version/TencentDocs-x86_64.exe#/dl.7z"
    }
}
