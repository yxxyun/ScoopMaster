{
	"version": "0",
	"description": "An extension allows you to write C# scripts to provide context menu items in Windows Explorer.",
	"homepage": "https://example.com/",
	"architecture": {
		"64bit": {
			"url": "https://github.com/GuanmingLu/ScoopBucket/releases/download/DynamicContext/DynamicContext_x64.7z",
			"hash": "173a10242f775762aa3ebf3cd9e924f3831c9e9645f454075902432f650f9bf5"
		},
		"32bit": {
			"url": "https://github.com/GuanmingLu/ScoopBucket/releases/download/DynamicContext/DynamicContext_x86.7z",
			"hash": "6a588a7eb0c7d43adb9f252ff4aea7feb97cb7d4b79834385f13ac55b5cd427f"
		}
	},
	"persist": [
		"Plugins",
		"config.json"
	],
	"pre_install": [
		"if (!(is_admin)) { error \"Requires admin rights!\"; break }",
		"$confirm = Read-Host \"Explorer will be restarted after installation. Continue? (y/n)\"",
		"if ($confirm -ne 'y') { break }",
		"if (!(Test-Path -Path \"$persist_dir\\config.json\")) {",
		"    Copy-Item -Path \"$dir\\InstallFiles\\config.json\" -Destination \"$persist_dir\\config.json\"",
		"}",
		"if (!(Test-Path -Path \"$persist_dir\\Plugins\")) {",
		"    New-Item -Path \"$persist_dir\\Plugins\" -ItemType Directory",
		"}",
		"if (!(Test-Path -Path \"$persist_dir\\Plugins\\cs\")) {",
		"    Copy-Item -Path \"$dir\\InstallFiles\\Plugins\\cs\" -Destination \"$persist_dir\\Plugins\\cs\" -Recurse",
		"}",
		"if (!(Test-Path -Path \"$persist_dir\\Plugins\\dll\")) {",
		"    Copy-Item -Path \"$dir\\InstallFiles\\Plugins\\dll\" -Destination \"$persist_dir\\Plugins\\dll\" -Recurse",
		"}",
		"Remove-Item -Path \"$dir\\InstallFiles\" -Recurse -Force"
	],
	"install": [
		"Invoke-ExternalCommand -FilePath \"$dir\\RegAsm.exe\" -ArgumentList '/CodeBase', '\"$persist_dir\\DynamicContext.dll\"' -RunAs -Wait"
	],
	"post_install": [
		"Remove-Item -Path \"$dir\\InstallFiles\" -Recurse -Force",
		"Stop-Process -processName: Explorer"
	],
	"pre_uninstall": [
		"if (!(is_admin)) { error \"Requires admin rights!\"; break }",
		"$confirm = Read-Host \"Explorer will be restarted before uninstallation. Continue? (y/n)\"",
		"if ($confirm -ne 'y') { break }",
		"Stop-Process -processName: Explorer",
		"Invoke-ExternalCommand -FilePath \"$dir\\RegAsm.exe\" -ArgumentList '/CodeBase', '/u', '\"$persist_dir\\DynamicContext.dll\"' -RunAs -Wait"
	]
}
