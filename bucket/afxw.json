{
    "version": "1.67-4.20",
    "description": "2-screen filer especially for keyboard-only usage",
    "homepage": "http://afxw.sakura.ne.jp/akt_afxw.html",
    "license": "Freeware",
    "architecture": {
        "64bit": {
            "url": [
                "http://afxw.sakura.ne.jp/lzh/afxw64_167.zip",
                "https://bitbucket.org/k_takata/bregonig/downloads/bron420.zip"
            ],
            "hash": [
                "631d91ea9ee5a48c45b980cd4266a33f3a1e683833084cf010f786367aad78aa",
                "15f58dd292aa6fc8fd592fa97a75d58b5680ddf7aa66ba10a2dd5c9f0ee159c1"
            ]
        },
        "32bit": {
            "url": [
                "http://afxw.sakura.ne.jp/lzh/afxw32_167.zip",
                "https://bitbucket.org/k_takata/bregonig/downloads/bron420.zip"
            ],
            "hash": [
                "f13fdd18c3a1dafa9df6297a9859d9fff573ae89473f312c5e95478c03e5d712",
                "15f58dd292aa6fc8fd592fa97a75d58b5680ddf7aa66ba10a2dd5c9f0ee159c1"
            ]
        }
    },
    "extract_to": [
        "",
        "bregonig"
    ],
    "bin": [
        "AFXW.EXE",
        "AFXWCFG.EXE"
    ],
    "pre_install": "foreach ($ext in ('DEF','HIS','INI','KEY')) { if (-not (Test-Path \"$persist_dir\\AFXW.$ext\")) { New-Item \"$dir\\AFXW.$ext\" | Out-Null } }",
    "persist": [
        "AFXW.DEF",
        "AFXW.HIS",
        "AFXW.INI",
        "AFXW.KEY"
    ],
    "post_install": [
        "Write-Host \"Placing bregonig.dll, migemo.dll and dict folder\"",
        "$arch=@{'64bit'='\\x64';'32bit'='\\.'}[$architecture]",
        "New-Item -Type HardLink -Target \"$dir\\bregonig\\$arch\\bregonig.dll\" -Path \"$dir\\bregonig.dll\" | Out-Null"
    ],
    "suggest": {
        "afxbkmk": "afxbkmk",
        "amkln": "amkln",
        "amksc": "amksc",
        "C/Migemo": "cmigemo"
    },
    "checkver": {
        "script": [
            "# akt_afxw.html is written in Shift_JIS but Content-Type is missing in response headers, so output is garbled. We can extract version information anyway.",
            "$temp=$page",
            "# Site closed, so disable fetching version info from there.",
            "#$stream=[System.Net.WebRequest]::Create('http://k-takata.o.oo7.jp/mysoft/bregonig.html').GetResponse().GetResponseStream()",
            "#$encoding = [System.Text.Encoding]::GetEncoding('Shift_JIS')",
            "#$temp+=(New-Object System.IO.StreamReader($stream, $encoding)).ReadToEnd()",
            "$temp+='bregonig.dll Ver.4.20.'",
            "return $temp"
        ],
        "regex": "<div id=\"mainbox\">(.|\\n)*?v (?<version1>\\d+)\\.(?<version2>\\d+)(.|\\n)*?bregonig.dll Ver\\.(?<bversion1>\\d+)\\.(?<bversion2>\\d+)(.|\\n)",
        "replace": "${version1}.${version2}-${bversion1}.${bversion2}"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": [
                    "http://afxw.sakura.ne.jp/lzh/afxw64_$matchVersion1$matchVersion2.zip",
                    "https://bitbucket.org/k_takata/bregonig/downloads/bron$matchBversion1$matchBversion2.zip"
                ]
            },
            "32bit": {
                "url": [
                    "http://afxw.sakura.ne.jp/lzh/afxw32_$matchVersion1$matchVersion2.zip",
                    "https://bitbucket.org/k_takata/bregonig/downloads/bron$matchBversion1$matchBversion2.zip"
                ]
            }
        }
    }
}
