{
    "version": "1.0.0.3",
    "homepage": "https://github.com/duanyll/Slide2Pdf",
    "description": "A PowerPoint add-in to export current slide to cropped PDF, especially for embedding into LaTeX documents.",
    "url": "https://cdn.duanyll.com/bin/slide2pdf/1.0.0.3.zip",
    "hash": "4D842E5DABDC32FB379D9096E8C23A5CBD4E3F927E75931F05766F109A6BC24B",
    "license": "MIT",
    "pre_install": [
        "Write-Host \"`nImportant Notes for Slide2Pdf Installation/Uninstallation:\"",
        "Write-Host \"----------------------------------------------------------\"",
        "Write-Host \"- The add-in is signed with a certificate that may not be pre-trusted on your system.\"",
        "Write-Host \"- During installation, a ClickOnce security dialog will likely appear.\"",
        "Write-Host \"  You will need to manually review the publisher information and click 'Install' to proceed.\"",
        "Write-Host \"----------------------------------------------------------`n\""
    ],
    "installer": {
        "script": [
            "$ErrorActionPreference = 'Stop'",
            "Write-Host 'Attempting to install VSTO add-in...'",
            "$vstoSubPath = 'Microsoft Shared\\VSTO\\10.0\\VSTOInstaller.exe'",
            "$vstoInstallerPath = $null",
            "$commonProgFiles = ${env:CommonProgramFiles}",
            "$commonProgFilesX86 = ${env:CommonProgramFiles`(x86`)}",

            "$potentialPaths = @()",
            "if ($commonProgFiles) { $potentialPaths += (Join-Path $commonProgFiles $vstoSubPath) }",
            "if ($commonProgFilesX86) { $potentialPaths += (Join-Path $commonProgFilesX86 $vstoSubPath) }",
            "Write-Host \"Searching for VSTOInstaller in: $($potentialPaths -join ', ')\"",
            "foreach ($pItem in $potentialPaths) {",
            "    if (Test-Path $pItem) {",
            "        $vstoInstallerPath = $pItem",
            "        break",
            "    }",
            "}",
            "if (-not $vstoInstallerPath) {",
            "    Write-Error 'VSTOInstaller.exe not found. Please ensure Office Shared Features or VSTO Runtime is installed.'",
            "    exit 1",
            "}",
            "Write-Host \"Using VSTOInstaller at: $vstoInstallerPath\"",
            "$slide2PdfVstoFile = Join-Path $dir 'Slide2Pdf.vsto'",
            "Write-Host \"Installing from: $slide2PdfVstoFile\"",
            "try {",
            "    Start-Process -FilePath $vstoInstallerPath -ArgumentList \"/i `\"$slide2PdfVstoFile`\"\" -Wait -ErrorAction Stop",
            "    Write-Host 'VSTO Add-in installation process initiated.'",
            "} catch {",
            "    Write-Error \"Error during VSTO installation: $($_.Exception.Message)\"",
            "    Write-Warning 'If a dialog appeared, manual interaction might have been required.'",
            "    Write-Warning 'If it failed, try running VSTOInstaller.exe manually with the .vsto file.'",
            "    exit 1",
            "}"
        ]
    },
    "uninstaller": {
        "script": [
            "$ErrorActionPreference = 'Stop'",
            "Write-Host 'Attempting to uninstall VSTO add-in...'",
            "$vstoSubPath = 'Microsoft Shared\\VSTO\\10.0\\VSTOInstaller.exe'",
            "$vstoInstallerPath = $null",
            "$commonProgFiles = ${env:CommonProgramFiles}",
            "$commonProgFilesX86 = ${env:CommonProgramFiles`(x86`)}",
            "$potentialPaths = @()",
            "if ($commonProgFiles) { $potentialPaths += (Join-Path $commonProgFiles $vstoSubPath) }",
            "if ($commonProgFilesX86) { $potentialPaths += (Join-Path $commonProgFilesX86 $vstoSubPath) }",
            "foreach ($pItem in $potentialPaths) {",
            "    if (Test-Path $pItem) {",
            "        $vstoInstallerPath = $pItem",
            "        break",
            "    }",
            "}",
            "if (-not $vstoInstallerPath) {",
            "    Write-Warning 'VSTOInstaller.exe not found. Uninstallation might require manual steps or Add/Remove Programs.'",
            "    exit 0",
            "}",
            "Write-Host \"Using VSTOInstaller at: $vstoInstallerPath\"",

            "$registeredVstoPath = Join-Path $dir 'Slide2Pdf.vsto' # This is the path Scoop knows",
            "Write-Host \"Attempting to uninstall using manifest: $registeredVstoPath (This might require the original deployment URL if different)\"",
            "try {",
            "    Start-Process -FilePath $vstoInstallerPath -ArgumentList \"/u `\"$registeredVstoPath`\" /s\" -Wait -ErrorAction SilentlyContinue",
            "    Write-Host 'VSTO Add-in uninstallation command executed.'",
            "    Write-Host 'Check Add/Remove Programs or Office application to confirm uninstallation.'",
            "} catch {",
            "    Write-Warning \"Error or non-standard exit during VSTO uninstallation: $($_.Exception.Message)\"",
            "    Write-Warning 'Manual uninstallation via Add/Remove Programs might be necessary.'",
            "}"
        ]
    }
}
