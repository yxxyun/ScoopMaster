{
  "version": "24.3-chs",
  "description": "MobaXterm 简体中文便携版：集成终端、SSH、SFTP、X11 的强大远程运维工具",
  "homepage": "https://github.com/RipplePiam/MobaXterm-Chinese-Simplified",
  "license": "Freeware",

  "url": "https://github.com/RipplePiam/MobaXterm-Chinese-Simplified/releases/download/v0.24.3.10/MobaXterm_Portable_v24.3_chs.zip",
  "hash": "md5:2216bb8085e2a3b726a9ea8817f6afef",

   "pre_install": [
    "# 把主程序统一改名",
    "Rename-Item \"$dir\\MobaXterm_Personal_24.3.exe\" 'MobaXterm.exe'",
  
    "# 如果已经存在同名目录，需要先删除，再创建空文件",
    "if (Test-Path \"$dir\\MobaXterm.ini\" -PathType Container) {",
    "    Remove-Item \"$dir\\MobaXterm.ini\" -Recurse -Force",
    "}",
    "if (!(Test-Path \"$dir\\MobaXterm.ini\" -PathType Leaf)) {",
    "    New-Item \"$dir\\MobaXterm.ini\" -Type File | Out-Null",
    "}",
  
    "# 持久化备份文件占位",
    "if (!(Test-Path \"$persist_dir\\MobaXterm backup.zip\")) {",
    "    New-Item \"$dir\\MobaXterm backup.zip\" -Type File | Out-Null",
    "}"
  ],

  "pre_uninstall": [
    "# 若运行期修改了 ini / 备份文件，卸载前同步回 persist",
    "function Sync([string] $f) {",
    "  if ((Get-Item \"$dir\\$f\").LastWriteTime -gt (Get-Item \"$persist_dir\\$f\").LastWriteTime) {",
    "    Copy-Item \"$dir\\$f\" \"$persist_dir\\$f\" -Force",
    "  }",
    "}",
    "@('MobaXterm.ini','MobaXterm backup.zip') | ForEach-Object { Sync $_ }"
  ],

  "bin": "MobaXterm.exe",
  "shortcuts": [
    [ "MobaXterm.exe", "MobaXterm 中文版" ]
  ],

  "persist": [
    "MobaXterm.ini",
    "MobaXterm backup.zip"
  ]
}
