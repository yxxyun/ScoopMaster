{
    "version": "1.17.5+98",
    "description": "Micro habit tracker for personal growth",
    "homepage": "https://github.com/FriesI23/mhabit",
    "license": "Apache-2.0",
    "notes": "",
    "architecture": {
        "64bit": {
            "url": "https://github.com/FriesI23/mhabit/releases/download/v1.17.5+98/mhabit_x64.msix",
            "hash": "55b2976e59e1b164a903ecae8ca3b966c089b8dd6a843fbb5c8a96a5eb2c54e4"
        }
    },
    "pre_install": [
        "if (scoop list \"^mhabit-beta$\" -ErrorAction SilentlyContinue) {",
        "    error \"Beta version already installed, Abort\"; break",
        "}",
        "",
        "$signature = Get-AuthenticodeSignature -FilePath \"$dir\\mhabit_*.msix\"",
        "$certificate = $signature.SignerCertificate",
        "",
        "$trusted = $false",
        "Get-ChildItem 'Cert:\\LocalMachine\\Root' | ForEach-Object {",
        "    if ($_.Thumbprint -eq $certificate.Thumbprint) { $trusted = $true }",
        "}",
        "",
        "if (!$trusted) {",
        "    if (!(is_admin)) { error \"$app requires admin rights to install certificate\"; break }",
        "    Write-Host 'Installing certificate' -ForegroundColor Yellow",
        "    $rootStore = Get-Item 'cert:\\LocalMachine\\Root'",
        "    $rootStore.Open('ReadWrite')",
        "    $rootStore.Add($certificate)",
        "    $rootStore.Close()",
        "}"
    ],
    "installer": {
        "script": [
            "try {",
            "  Add-AppPackage -Path \"$dir\\mhabit_x64.msix\" -ErrorAction Stop",
            "} catch {",
            "  error \"Failed to install MSIX package: $_\"",
            "  break",
            "}"
        ]
    },
    "uninstaller": {
        "script": "Get-AppPackage 'Github.FriesI23.TableHabit' | Remove-AppPackage"
    },
    "checkver": {
        "url": "https://github.com/FriesI23/mhabit/releases/latest",
        "regex": "\\/releases\\/tag\\/v([\\d.]+\\+\\d+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/FriesI23/mhabit/releases/download/v$version/mhabit_x64.msix"
            }
        }
    }
}
