{
    "version": "4.8.4.2",
    "description": "A unlimited speed multifunctional remote control software",
    "homepage": "https://www.todesk.com/",
    "license": "Proprietary",
    "architecture": {
        "64bit": {
            "url": "https://dl.todesk.com/irrigation/ToDesk_4.8.4.2.exe#/dl.7z",
            "hash": "60aefdd45af0879694e189c66e8639171e4b0d30d5bc5fd1828f0d4311fa8e3c"
        }
    },
    "pre_install": [
        "if (!(Test-Path \"$persist_dir\\config.ini\")) {",
        "    New-Item -Force -Path \"$persist_dir\\config.ini\" -ItemType File -Value \"[ConfigInfo]`nautoStart=0\" | Out-Null",
        "}",
        "# 解压对应架构的7z文件",
        "if ($architecture -eq '64bit') {",
        "    Get-ChildItem \"$dir\\app64.7z\" | Expand-7zipArchive -DestinationPath \"$dir\"",
        "} else {",
        "    Get-ChildItem \"$dir\\app32.7z\" | Expand-7zipArchive -DestinationPath \"$dir\"",
        "}"
    ],
    "post_install": [
        "# 清理不必要的文件",
        "Remove-Item \"$dir\\app32.7z\", \"$dir\\app64.7z\" -Force -ErrorAction SilentlyContinue",
        "Remove-Item \"$dir\\`$PLUGINSDIR\" -Force -Recurse -ErrorAction SilentlyContinue",
        "Remove-Item \"$dir\\uninst.exe\" -Force -ErrorAction SilentlyContinue"
    ],
    "shortcuts": [
        [
            "ToDesk.exe",
            "ToDesk"
        ]
    ],
    "persist": [
        "Logs",
        "config.ini"
    ],
    "checkver": {
        "url": "https://www.todesk.com/download.html",
        "regex": "ToDesk_([\\d.]+).exe"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://dl.todesk.com/irrigation/ToDesk_$version.exe#/dl.7z"
            }
        }
    }
}
