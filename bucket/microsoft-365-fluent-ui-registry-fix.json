{
   "$schema": "https://raw.githubusercontent.com/lukesampson/scoop/master/schema.json",
   "version": "1.0.0",
   "description": "Fix Microsoft 365 registry. This enables Fluent UI for Microsoft 365.",
   "url": "https://raw.githubusercontent.com/silver886/scoop/master/LICENSE",
   "hash": "7e12e5df4bae12cb21581ba157ced20e1986a0508dd10d0e8a4ab9a4cf94e85c",
   "installer": {
      "script": [
         "$registryPath = 'HKCU:\\Software\\Microsoft\\Office\\16.0\\Common\\ExperimentConfigs\\ExternalFeatureOverrides'",
         "$applications = @(",
         "   'access'",
         "   'excel'",
         "   'onenote'",
         "   'outlook'",
         "   'powerpoint'",
         "   'project'",
         "   'publisher'",
         "   'visio'",
         "   'word'",
         ")",
         "$properties = @(",
         "   'Microsoft.Office.UXPlatform.FluentSVRefresh'",
         "   'Microsoft.Office.UXPlatform.RibbonTouchOptimization'",
         "   'Microsoft.Office.UXPlatform.FluentSVRibbonOptionsMenu'",
         ")",
         "$applications | ForEach-Object {",
         "   New-Item -Path \"$registryPath\\$_\" -Force > $null",
         "   $application = $_",
         "   $properties | ForEach-Object {",
         "      New-ItemProperty -Path \"$registryPath\\$application\" -Name $_ -PropertyType String -Value 'true' -Force > $null",
         "   }",
         "}"
      ]
   },
   "uninstaller": {
      "script": [
         "$registryPath = 'HKCU:\\Software\\Microsoft\\Office\\16.0\\Common\\ExperimentConfigs\\ExternalFeatureOverrides'",
         "$applications = @(",
         "   'access'",
         "   'excel'",
         "   'onenote'",
         "   'outlook'",
         "   'powerpoint'",
         "   'project'",
         "   'publisher'",
         "   'visio'",
         "   'word'",
         ")",
         "$properties = @(",
         "   'Microsoft.Office.UXPlatform.FluentSVRefresh'",
         "   'Microsoft.Office.UXPlatform.RibbonTouchOptimization'",
         "   'Microsoft.Office.UXPlatform.FluentSVRibbonOptionsMenu'",
         ")",
         "$applications | ForEach-Object {",
         "   $application = $_",
         "   $properties | ForEach-Object {",
         "      Remove-ItemProperty -Path \"$registryPath\\$application\" -Name $_ > $null",
         "   }",
         "}"
      ]
   }
}
