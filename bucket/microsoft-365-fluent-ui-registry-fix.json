{
   "$schema": "https://raw.githubusercontent.com/lukesampson/scoop/master/schema.json",
   "version": "1.0.0",
   "description": "Fix Microsoft 365 registry. This enables Fluent UI for Microsoft 365.",
   "url": "https://raw.githubusercontent.com/silver886/scoop/master/bucket/microsoft-365-fluent-ui-registry-fix.json",
   "hash": "81637171bc0a9214d339b723b1822174509f00e91f6c551a37e344bf64a3ed83",
   "installer": {
      "script": [
         "$registryPath = 'HKCU:\\Software\\Microsoft\\Office\\16.0\\Common\\ExperimentConfigs\\ExternalFeatureOverrides'",
         "$applications = @(",
         "   'access'",
         "   'excel'",
         "   'onenote'",
         "   'outlook'",
         "   'powerpoint'",
         "   'project'",
         "   'publisher'",
         "   'visio'",
         "   'word'",
         ")",
         "$properties = @(",
         "   'Microsoft.Office.UXPlatform.FluentSVRefresh'",
         "   'Microsoft.Office.UXPlatform.RibbonTouchOptimization'",
         "   'Microsoft.Office.UXPlatform.FluentSVRibbonOptionsMenu'",
         ")",
         "$applications | ForEach-Object {",
         "   New-Item -Path \"$registryPath\\$_\" -Force > $null",
         "   $application = $_",
         "   $properties | ForEach-Object {",
         "      New-ItemProperty -Path \"$registryPath\\$application\" -Name $_ -PropertyType String -Value 'true' -Force > $null",
         "   }",
         "}"
      ]
   },
   "uninstaller": {
      "script": [
         "$registryPath = 'HKCU:\\Software\\Microsoft\\Office\\16.0\\Common\\ExperimentConfigs\\ExternalFeatureOverrides'",
         "$applications = @(",
         "   'access'",
         "   'excel'",
         "   'onenote'",
         "   'outlook'",
         "   'powerpoint'",
         "   'project'",
         "   'publisher'",
         "   'visio'",
         "   'word'",
         ")",
         "$properties = @(",
         "   'Microsoft.Office.UXPlatform.FluentSVRefresh'",
         "   'Microsoft.Office.UXPlatform.RibbonTouchOptimization'",
         "   'Microsoft.Office.UXPlatform.FluentSVRibbonOptionsMenu'",
         ")",
         "$applications | ForEach-Object {",
         "   $application = $_",
         "   $properties | ForEach-Object {",
         "      Remove-ItemProperty -Path \"$registryPath\\$application\" -Name $_ > $null",
         "   }",
         "}"
      ]
   },
   "checkver": {
      "url": "https://raw.githubusercontent.com/silver886/scoop/master/bucket/microsoft-365-fluent-ui-registry-fix.json",
      "jsonpath": "$.version"
   },
   "autoupdate": {
      "url": "https://raw.githubusercontent.com/silver886/scoop/master/bucket/microsoft-365-fluent-ui-registry-fix.json"
   }
}
