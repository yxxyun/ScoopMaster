{
    "version": "2.500",
    "description": "A programming font focused on source code legibility",
    "homepage": "https://github.com/0xType/0xProto",
    "license": "OFL-1.1",
    "url": "https://github.com/0xType/0xProto/releases/download/2.500/0xProto_2_500.zip",
    "hash": "eb7a786c9f4b4d89c6c8e4cf406f96b21f13464ed8b9631db30002045a5ac794",
    "extract_dir": "No-Ligatures",
    "installer": {
        "script": [
            "$filter = '*.ttf'",
            "Add-Type -AssemblyName PresentationCore, WindowsBase",
            "$fontDir = if ($global) { \"${env:WINDIR}\\Fonts\" } else { \"${env:LOCALAPPDATA}\\Microsoft\\Windows\\Fonts\" }",
            "$regDrive = if ($global) { 'HKLM:' } else { 'HKCU:' }",
            "$regKey = \"$regDrive\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\"",
            "$files = Get-ChildItem $dir -Recurse -File | Where-Object { $_.Name -like '*.[ot]tf' } | Where-Object { $_.Name -like $filter }",
            "if ($files.Count -eq 0) {",
            "    throw 'Failed to find fonts to install. Please recheck the filter.'",
            "}",
            "$junk = Get-ChildItem $dir -Recurse -File | Where-Object { $_.Name -like '*.[ot]tf' } | Where-Object { $_.Name -notlike $filter }",
            "foreach ($file in $junk) {",
            "    Remove-Item -Force -Path $file.FullName -ErrorAction SilentlyContinue",
            "}",
            "$fonts = @()",
            "foreach ($file in $files) {",
            "    if (-not ($file.Name -match '\\.(ttf|otf)$')) {",
            "        throw 'Unsupported font format. Please use TTF or OTF files.'",
            "    }",
            "    $fileUri = [uri]::new($file.FullName)",
            "    $glyphTypeface = $null",
            "    $regValueName = $null",
            "    try {",
            "        $glyphTypeface = [System.Windows.Media.GlyphTypeface]::new($fileUri)",
            "        if ($null -ne $glyphTypeface) {",
            "            $culture = [System.Globalization.CultureInfo]::CurrentCulture",
            "            $fontFamilyName = $null",
            "            if (($null -ne $glyphTypeface.FamilyNames) -and ($glyphTypeface.FamilyNames.Count -ne 0)) {",
            "                if ($glyphTypeface.FamilyNames.ContainsKey($culture.LCID)) {",
            "                    $fontFamilyName = $glyphTypeface.FamilyNames[$culture.LCID]",
            "                } elseif ($glyphTypeface.FamilyNames.ContainsKey(0x0409)) {",
            "                    $fontFamilyName = $glyphTypeface.FamilyNames[0x0409] # en-US",
            "                }",
            "            }",
            "            $fontFaceName = $null",
            "            if (($null -ne $glyphTypeface.FaceNames) -and ($glyphTypeface.FaceNames.Count -ne 0)) {",
            "                if ($glyphTypeface.FaceNames.ContainsKey($culture.LCID)) {",
            "                    $fontFaceName = $glyphTypeface.FaceNames[$culture.LCID]",
            "                } elseif ($glyphTypeface.FaceNames.ContainsKey(0x0409)) {",
            "                    $fontFaceName = $glyphTypeface.FaceNames[0x0409] # en-US",
            "                }",
            "            }",
            "            if (($null -ne $fontFamilyName) -and ($null -ne $fontFaceName)) {",
            "                $fontFamilyName = $fontFamilyName.Trim()",
            "                $fontFaceName = $fontFaceName.Trim()",
            "                $regValueName = \"$fontFamilyName $fontFaceName (TrueType)\"",
            "            }",
            "        }",
            "    } finally {",
            "        $glyphTypeface = $null",
            "        [System.GC]::Collect()",
            "        [System.GC]::WaitForPendingFinalizers()",
            "    }",
            "    if ($null -eq $regValueName) {",
            "        Write-Warning \"Could not determine font family name from metadata; using filename instead.\"",
            "        $regValueName = $file.BaseName -replace '[-_]+', ' '",
            "    }",
            "    $font = [PSCustomObject]@{",
            "        File     = $file",
            "        Registry = $regValueName",
            "        Success  = $false",
            "    }",
            "    $fonts += $font",
            "    $fontPath = \"$fontDir\\$($file.Name)\"",
            "    $regValueData = if ($global) { $file.Name } else { $fontPath }",
            "    if (Test-Path $fontPath) {",
            "        [System.GC]::Collect()",
            "        [System.GC]::WaitForPendingFinalizers()",
            "        [System.GC]::Collect()",
            "        Remove-Item -Path $fontPath -Force -ErrorAction Stop",
            "        Start-Sleep -Milliseconds 100  # Give Windows a moment to release the file handle",
            "    }",
            "    Copy-Item -Force -Path $file.FullName -Destination $fontDir -ErrorAction Stop",
            "    $existingKey = Get-ItemProperty -Path $regKey -Name $regValueName -ErrorAction SilentlyContinue",
            "    if ($null -eq $existingKey) {",
            "        New-ItemProperty -Force -Path $regKey -Name $regValueName -Value $regValueData -PropertyType String -ErrorAction Stop | Out-Null",
            "    } else {",
            "        Set-ItemProperty -Force -Path $regKey -Name $regValueName -Value $regValueData -ErrorAction Stop | Out-Null",
            "    }",
            "    $font.Success = $true",
            "}"
        ]
    },
    "uninstaller": {
        "script": [
            "$filter = '*.ttf'",
            "Add-Type -AssemblyName PresentationCore, WindowsBase",
            "$fontDir = if ($global) { \"${env:WINDIR}\\Fonts\" } else { \"${env:LOCALAPPDATA}\\Microsoft\\Windows\\Fonts\" }",
            "$regDrive = if ($global) { 'HKLM:' } else { 'HKCU:' }",
            "$regKey = \"$regDrive\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\"",
            "$files = Get-ChildItem $dir -Recurse -File | Where-Object { $_.Name -like '*.[ot]tf' } | Where-Object { $_.Name -like $filter }",
            "if ($files.Count -eq 0) {",
            "    throw 'Failed to find fonts to install. Please recheck the filter.'",
            "}",
            "$fonts = @()",
            "foreach ($file in $files) {",
            "    if (-not ($file.Name -match '\\.(ttf|otf)$')) {",
            "        throw 'Unsupported font format. Please use TTF or OTF files.'",
            "    }",
            "    $fileUri = [uri]::new($file.FullName)",
            "    $glyphTypeface = $null",
            "    $regValueName = $null",
            "    try {",
            "        $glyphTypeface = [System.Windows.Media.GlyphTypeface]::new($fileUri)",
            "        if ($null -ne $glyphTypeface) {",
            "            $culture = [System.Globalization.CultureInfo]::CurrentCulture",
            "            $fontFamilyName = $null",
            "            if (($null -ne $glyphTypeface.FamilyNames) -and ($glyphTypeface.FamilyNames.Count -ne 0)) {",
            "                if ($glyphTypeface.FamilyNames.ContainsKey($culture.LCID)) {",
            "                    $fontFamilyName = $glyphTypeface.FamilyNames[$culture.LCID]",
            "                } elseif ($glyphTypeface.FamilyNames.ContainsKey(0x0409)) {",
            "                    $fontFamilyName = $glyphTypeface.FamilyNames[0x0409] # en-US",
            "                }",
            "            }",
            "            $fontFaceName = $null",
            "            if (($null -ne $glyphTypeface.FaceNames) -and ($glyphTypeface.FaceNames.Count -ne 0)) {",
            "                if ($glyphTypeface.FaceNames.ContainsKey($culture.LCID)) {",
            "                    $fontFaceName = $glyphTypeface.FaceNames[$culture.LCID]",
            "                } elseif ($glyphTypeface.FaceNames.ContainsKey(0x0409)) {",
            "                    $fontFaceName = $glyphTypeface.FaceNames[0x0409] # en-US",
            "                }",
            "            }",
            "            if (($null -ne $fontFamilyName) -and ($null -ne $fontFaceName)) {",
            "                $fontFamilyName = $fontFamilyName.Trim()",
            "                $fontFaceName = $fontFaceName.Trim()",
            "                $regValueName = \"$fontFamilyName $fontFaceName (TrueType)\"",
            "            }",
            "        }",
            "    } finally {",
            "        $glyphTypeface = $null",
            "        [System.GC]::Collect()",
            "        [System.GC]::WaitForPendingFinalizers()",
            "    }",
            "    $font = [PSCustomObject]@{",
            "        File     = $file",
            "        Registry = $regValueName",
            "        Success  = $false",
            "    }",
            "    $fonts += $font",
            "    $fontPath = \"$fontDir\\$($file.Name)\"",
            "    if (Test-Path $fontPath) {",
            "        [System.GC]::Collect()",
            "        [System.GC]::WaitForPendingFinalizers()",
            "        [System.GC]::Collect()",
            "        Remove-Item -Path $fontPath -Force -ErrorAction Stop",
            "        Start-Sleep -Milliseconds 100  # Give Windows a moment to release the file handle",
            "    }",
            "    Remove-ItemProperty -Path $regKey -Name $regValueName -ErrorAction Stop",
            "    $font.Success = $true",
            "}"
        ]
    },
    "checkver": {
        "url": "https://api.github.com/repos/0xType/0xProto/releases",
        "jsonpath": "$[*].assets[*].browser_download_url",
        "regex": "/v?([\\d.]+)/.*.zip"
    },
    "autoupdate": {
        "url": "https://github.com/0xType/0xProto/releases/download/$version/0xProto_$underscoreVersion.zip"
    }
}
