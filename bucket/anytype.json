{
    "version": "0.49.65-beta",
    "description": "Local-first, E2E encrypted software for creating and storing tasks, notes, ideas, documents, workflows, and more.",
    "homepage": "https://anytype.io/",
    "license": {
        "identifier": "Freeware",
        "url": "https://anytype.io/terms_of_use"
    },
    "architecture": {
        "64bit": {
            "url": "https://github.com/anyproto/anytype-ts/releases/download/v0.49.65-beta/Anytype.Setup.0.49.65-beta.exe#/dl.7z",
            "hash": "ccefa47191148c0dfa2da1169621e6ee3bfb5669de0512c07eb4fb9bf0a61fe7",
            "pre_install": [
                "Remove-Item \"$dir\\resources\" -Recurse",
                "Expand-7zipArchive \"$dir\\`$PLUGINSDIR\\app-64.7z\" \"$dir\"",
                "Remove-Item \"$dir\\`$*\" -Recurse"
            ],
            "post_install": [
                "Write-Host '正在配置 Anytype 便携化...' -ForegroundColor Yellow",
                "$dataDir = \"$persist_dir\\data\"",
                "$appDataPath = \"$env:APPDATA\\anytype\"",
                "$updaterPath = \"$env:LOCALAPPDATA\\anytype-updater\"",
                "if (-not (Test-Path $dataDir)) { New-Item -ItemType Directory -Path $dataDir -Force | Out-Null }",
                "if (Test-Path $appDataPath) {",
                "    if (-not (Get-Item $appDataPath).LinkType) {",
                "        Write-Host '备份现有数据到便携化目录...' -ForegroundColor Cyan",
                "        Copy-Item -Path \"$appDataPath\\*\" -Destination $dataDir -Recurse -Force",
                "        Remove-Item $appDataPath -Recurse -Force",
                "    }",
                "}",
                "try {",
                "    New-Item -ItemType Junction -Path $appDataPath -Target $dataDir -Force | Out-Null",
                "    Write-Host 'Anytype 便携化配置完成！' -ForegroundColor Green",
                "} catch {",
                "    Write-Host '创建junction失败，可能需要管理员权限或开发者模式' -ForegroundColor Red",
                "    Write-Host '请以管理员身份运行或启用开发者模式' -ForegroundColor Yellow",
                "}",
                "if (Test-Path $updaterPath) {",
                "    if (-not (Get-Item $updaterPath).LinkType) {",
                "        Remove-Item $updaterPath -Recurse -Force",
                "    }",
                "}",
                "try {",
                "    New-Item -ItemType File -Path $updaterPath -Force | Out-Null",
                "    Write-Host '已创建阻止文件防止anytype-updater目录生成' -ForegroundColor Green",
                "} catch {",
                "    Write-Host '创建阻止文件失败: $_' -ForegroundColor Yellow",
                "}"
            ]
        }
    },
    "persist": "data",
    "uninstaller": {
        "script": [
            "$appDataPath = \"$env:APPDATA\\anytype\"",
            "$updaterPath = \"$env:LOCALAPPDATA\\anytype-updater\"",
            "if (Test-Path $appDataPath) {",
            "    if ((Get-Item $appDataPath).LinkType -eq 'Junction') {",
            "        Remove-Item $appDataPath -Force",
            "        Write-Host 'Anytype 便携化junction已清理' -ForegroundColor Green",
            "    }",
            "}",
            "if (Test-Path $updaterPath -PathType Leaf) {",
            "    Remove-Item $updaterPath -Force",
            "    Write-Host 'anytype-updater阻止文件已清理' -ForegroundColor Green",
            "}"
        ]
    },
    "shortcuts": [
        [
            "Anytype.exe",
            "Anytype"
        ]
    ],
    "checkver": {
        "url": "https://api.github.com/repos/anyproto/anytype-ts/releases/latest",
        "jsonpath": "$.tag_name",
        "regex": "v([\\d.]+(?:-[A-Za-z0-9.-]+)?)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/anyproto/anytype-ts/releases/download/v$version/Anytype.Setup.$version.exe#/dl.7z"
            }
        }
    }
}
