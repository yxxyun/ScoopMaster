{
    "version": "1.5.0-1133-g03c2ae9",
    "description": "Sega Dreamcast emulator (dev branch) that can render games in HD (IMPROVED SETUP AND PERSIST LOGIC)",
    "homepage": "https://redream.io",
    "license": {
        "identifier": "Freeware",
        "url": "https://redream.io"
    },
    "architecture": {
        "64bit": {
            "url": "https://redream.io/download/redream.x86_64-windows-v1.5.0-1133-g03c2ae9.zip",
            "hash": "47317a82db7ec1e91a777504b35a11fbf5ba94347a848d12cb8d68f9175153ff"
        }
    },
    "pre_install": [
        "function b64Dec ([String] $compBase64) {",
        "    $compressedBytes = [Convert]::FromBase64String($compBase64)",
        "    $inputStream = [System.IO.MemoryStream]::new($compressedBytes)",
        "    $outputStream = [System.IO.MemoryStream]::new()",
        "    $gzipStream = [System.IO.Compression.gzipStream]::new( $inputStream, [System.IO.Compression.CompressionMode]::Decompress )",
        "    $gzipStream.CopyTo($outputStream)",
        "    $gzipStream.Dispose(); $inputStream.Dispose(); $outputStream.Dispose()",
        "    return $outputStream",
        "}",
        "function persistVMU ([String] $name) {",
        "    if (!(Test-Path \"$persist_dir\\$name\")) { ",
        "        Write-Host \"No '$name' exists. Generating valid VMU for persisting.\" -f Yellow",
        "	     $vmuStream = b64Dec \"H4sIAAAAAAAEAO3SPQ5BURAG0O8lWoVSpbQiieVYhiXZjn+ux3UjUVCoaOScLzOZybSTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvOqr/HdKXWeTbXbZ55BjTjmn5JI+pd1mb7rafPiX8XI0TeaD514fdUuXa4ZtXmXS+uLHX8u33AEdZ6XYAAACAA==\"",
        "        Set-Content \"$dir\\$name\" -Value $vmuStream.ToArray() -Encoding Byte | Out-Null",
        "    }",
        "}",
        "function persistFlash() {",
        "    if (!(Test-Path \"$persist_dir\\flash.bin\")) { ",
        "        Write-Host \"No 'flash.bin' exists. Generating valid flash for persisting.\" -f Yellow",
        "	     $flashStream = b64Dec \"H4sIAAAAAAAEAO3bv2pTURzA8ZPW4GIHp8ai5W6CINzQQbSKHEnSlMS0JBH8M4SgmaxSbXEqCPYBuoibk4P0CcTFQRBcHd19AB+gEFPiUDSgNxlSyuezXO7hfvmdc7nrrcV2bMROpR5b1c7AqdDP5GC2VV4Z9NW02FmrZYz7n75lDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE6sl1OeX4vt2IidSj22qp2B2ZCtL4Rcv11cStNiI0mSW/U75aTVXm2slJvJf7ixtRDmdgp7uTDK6NWh4fT02bmQZWYclIfzvs8P+3cHC6EwuJ8ZOWP06tH5b7fPD85fLTUvp+mVq0nSiOvr9XI71stJbLZWY7LaSErxXqlZjrdH7efs8mK4PsH5d5cvhKfdzc2N3nZ3o/fv950flIfzXj8a9j9OL4bKBOe/+HEhXHtV2Jsd+czo1aP9+8eL4cME/efSeF89AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcBKFm9PeAQAAAAAAAAAwbWlaLKal573uk4fdre0kmfZ+/nTc9wcAAAAAAAAAx0EttmMjdir12Kp2BmZCtj4f9u/O7/VzITfO9EsvJu937o/f7/cm78/sFMbu18r58OV3P3d4zejrUj783B2/fxDzof1m/D6/lrUAAAAAAAAAAAAAAAAAAAA4qTL+rv+XXx/ntLkAAAIA\"",
        "        Set-Content \"$dir\\flash.bin\" -Value $flashStream.ToArray() -Encoding Byte | Out-Null",
        "    }",
        "}",
        "function persistKey() {",
        "    New-Item -ItemType HardLink -Path \"$dir\\redream.key\" -Value \"$persist_dir\\redream.key\" | Out-Null",
        "    Write-Host \"Persisting redream.key\"",
        "}",
        "function askKey() {",
        "    if (Test-Path \"$persist_dir\\redream.key\") { persistKey }",
        "    if (!(Test-Path \"$persist_dir\\redream.key\")) { ",
        "        New-Item -ItemType Directory \"$persist_dir\" | Out-Null",
        "        Write-Host \"Copy your redream.key license file into '$persist_dir' if you own one and press any key to continue.\" -f Blue",
        "        [void][System.Console]::ReadKey($true)",
        "        if (Test-Path \"$persist_dir\\redream.key\") { persistKey }",
        "    }",
        "}",
        "persistVMU \"vmu0.bin\"; persistVMU \"vmu1.bin\"; persistVMU \"vmu2.bin\"; persistVMU \"vmu3.bin\"",
        "persistFlash; askKey",
        "if (!(Test-Path \"$persist_dir\\redream.cfg\")) { New-Item -ItemType File \"$dir\\redream.cfg\" | Out-Null }"
    ],
    "bin": "redream.exe",
    "shortcuts": [
        [
            "redream.exe",
            "Redream (dev)"
        ]
    ],
    "persist": [
        "cache",
        "saves",
        "states",
        "flash.bin",
        "redream.cfg",
        "vmu0.bin",
        "vmu1.bin",
        "vmu2.bin",
        "vmu3.bin"
    ],
    "checkver": {
        "url": "https://redream.io/download",
        "regex": "v(\\d\\.\\d\\.\\d-\\d{4}-g[a-f0-9]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://redream.io/download/redream.x86_64-windows-v$version.zip"
            }
        }
    }
}
