{
   "$schema": "https://raw.githubusercontent.com/lukesampson/scoop/master/schema.json",
   "version": "1.0.0",
   "description": "Fix Typora registry. This disables 15-day trial period.",
   "suggest": {
      "Typora": "extras/typora"
   },
   "url": "https://raw.githubusercontent.com/silver886/scoop/master/LICENSE",
   "hash": "7e12e5df4bae12cb21581ba157ced20e1986a0508dd10d0e8a4ab9a4cf94e85c",
   "installer": {
      "script": [
         "$TyporaPath = 'Software\\Typora'",
         "New-Item -Path \"HKCU:\\$TyporaPath\" -ErrorAction SilentlyContinue > $null",
         "$TyporaKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($TyporaPath, [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree, [System.Security.AccessControl.RegistryRights]::ChangePermissions)",
         "$Acl = $TyporaKey.GetAccessControl()",
         "$Acl.AddAccessRule((New-Object System.Security.AccessControl.RegistryAccessRule($env:USERNAME,'ReadKey',@('ObjectInherit','ContainerInherit'),'None','Deny')))",
         "$TyporaKey.SetAccessControl($Acl)"
      ]
   },
   "uninstaller": {
      "script": [
         "$TyporaPath = 'Software\\Typora'",
         "$TyporaKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($TyporaPath, [Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree, [System.Security.AccessControl.RegistryRights]::ChangePermissions)",
         "$Acl = $TyporaKey.GetAccessControl()",
         "$Acl.RemoveAccessRule((New-Object System.Security.AccessControl.RegistryAccessRule($env:USERNAME,'ReadKey',@('ObjectInherit','ContainerInherit'),'None','Deny')))",
         "$TyporaKey.SetAccessControl($Acl)"
      ]
   }
}
